INFO:root:predictions: [7, 2, 1, 0, 4, 1, 4, 9, 5, 9, 0, 6, 9, 0, 1, 5, 9, 7, 8, 4, 9, 6, 6, 5, 4, 0, 7, 4, 0, 1, 3, 1]
INFO:root:labels: [7 2 1 0 4 1 4 9 5 9 0 6 9 0 1 5 9 7 3 4 9 6 6 5 4 0 7 4 0 1 3 1]
INFO:root:test loss: 0.048442352563142776, test accuracy: 0.96875
INFO:root:predictions: [3, 4, 7, 2, 7, 1, 2, 1, 1, 7, 4, 2, 3, 5, 1, 2, 4, 4, 6, 3, 5, 5, 6, 0, 4, 1, 9, 5, 7, 8, 9, 3]
INFO:root:labels: [3 4 7 2 7 1 2 1 1 7 4 2 3 5 1 2 4 4 6 3 5 5 6 0 4 1 9 5 7 8 9 3]
INFO:root:test loss: 0.03394612297415733, test accuracy: 0.6979166865348816
INFO:root:predictions: [7, 4, 6, 4, 3, 0, 7, 0, 2, 9, 1, 7, 3, 2, 9, 7, 7, 6, 2, 7, 8, 4, 7, 3, 6, 1, 3, 6, 9, 3, 1, 4]
INFO:root:labels: [7 4 6 4 3 0 7 0 2 9 1 7 3 2 9 7 7 6 2 7 8 4 7 3 6 1 3 6 9 3 1 4]
INFO:root:test loss: 0.025930166244506836, test accuracy: 0.5416666865348816
INFO:root:predictions: [1, 7, 6, 9, 6, 0, 5, 4, 9, 9, 2, 1, 9, 4, 8, 7, 3, 9, 7, 4, 4, 4, 9, 2, 5, 4, 7, 6, 4, 9, 0, 5]
INFO:root:labels: [1 7 6 9 6 0 5 4 9 9 2 1 9 4 8 7 3 9 7 4 4 4 9 2 5 4 7 6 7 9 0 5]
INFO:root:test loss: 0.029725471511483192, test accuracy: 0.45625001192092896
INFO:root:predictions: [8, 5, 6, 6, 5, 7, 8, 1, 0, 1, 6, 4, 6, 7, 3, 1, 7, 1, 8, 2, 0, 2, 9, 9, 5, 5, 1, 5, 6, 0, 3, 4]
INFO:root:labels: [8 5 6 6 5 7 8 1 0 1 6 4 6 7 3 1 7 1 8 2 0 2 9 9 5 5 1 5 6 0 3 4]
INFO:root:test loss: 0.03055626153945923, test accuracy: 0.3916666805744171
WARNING:tensorflow:Model was constructed with shape (None, 28, 28, 1) for input Tensor("conv2d_input:0", shape=(None, 28, 28, 1), dtype=float32), but it was called on an input with incompatible shape (32, 10).
ERROR:grpc._server:Exception calling application: input tensor must have rank 4
Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 930, in merge_with
    self.assert_same_rank(other)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 985, in assert_same_rank
    (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) must have the same rank

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 1015, in with_rank
    return self.merge_with(unknown_shape(rank=rank))
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 936, in merge_with
    raise ValueError("Shapes %s and %s are not compatible" % (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) are not compatible

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/ops/nn_ops.py", line 1039, in __init__
    input_shape.with_rank(num_spatial_dims + 2)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 1017, in with_rank
    raise ValueError("Shape %s must have rank %d" % (self, rank))
ValueError: Shape (32, 10) must have rank 4

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 53, in process_tensor
    result = self.model.process_data(parsed)
  File "inference.py", line 109, in process_data
    result = self.model(input_data)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/sequential.py", line 277, in call
    return super(Sequential, self).call(inputs, training=training, mask=mask)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/network.py", line 719, in call
    convert_kwargs_to_constants=base_layer_utils.call_context().saving)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/network.py", line 888, in _run_internal_graph
    output_tensors = layer(computed_tensors, **kwargs)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/layers/convolutional.py", line 201, in call
    data_format=self._conv_op_data_format)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/ops/nn_ops.py", line 1042, in __init__
    "input tensor must have rank %d" % (num_spatial_dims + 2))
ValueError: input tensor must have rank 4
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7f91a80ab400>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: input tensor must have rank 4"
	debug_error_string = "{"created":"@1592902235.156260984","description":"Error received from peer ipv6:[::1]:50053","file":"src/core/lib/surface/call.cc","file_line":1056,"grpc_message":"Exception calling application: input tensor must have rank 4","grpc_status":2}"
>
WARNING:tensorflow:Model was constructed with shape (None, 28, 28, 1) for input Tensor("conv2d_input:0", shape=(None, 28, 28, 1), dtype=float32), but it was called on an input with incompatible shape (32, 10).
ERROR:grpc._server:Exception calling application: input tensor must have rank 4
Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 930, in merge_with
    self.assert_same_rank(other)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 985, in assert_same_rank
    (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) must have the same rank

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 1015, in with_rank
    return self.merge_with(unknown_shape(rank=rank))
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 936, in merge_with
    raise ValueError("Shapes %s and %s are not compatible" % (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) are not compatible

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/ops/nn_ops.py", line 1039, in __init__
    input_shape.with_rank(num_spatial_dims + 2)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 1017, in with_rank
    raise ValueError("Shape %s must have rank %d" % (self, rank))
ValueError: Shape (32, 10) must have rank 4

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 53, in process_tensor
    result = self.model.process_data(parsed)
  File "inference.py", line 109, in process_data
    result = self.model(input_data)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/sequential.py", line 277, in call
    return super(Sequential, self).call(inputs, training=training, mask=mask)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/network.py", line 719, in call
    convert_kwargs_to_constants=base_layer_utils.call_context().saving)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/network.py", line 888, in _run_internal_graph
    output_tensors = layer(computed_tensors, **kwargs)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/layers/convolutional.py", line 201, in call
    data_format=self._conv_op_data_format)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/ops/nn_ops.py", line 1042, in __init__
    "input tensor must have rank %d" % (num_spatial_dims + 2))
ValueError: input tensor must have rank 4
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7f91a80ab268>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: input tensor must have rank 4"
	debug_error_string = "{"created":"@1592902236.168449008","description":"Error received from peer ipv6:[::1]:50053","file":"src/core/lib/surface/call.cc","file_line":1056,"grpc_message":"Exception calling application: input tensor must have rank 4","grpc_status":2}"
>
WARNING:tensorflow:Model was constructed with shape (None, 28, 28, 1) for input Tensor("conv2d_input:0", shape=(None, 28, 28, 1), dtype=float32), but it was called on an input with incompatible shape (32, 10).
ERROR:grpc._server:Exception calling application: input tensor must have rank 4
Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 930, in merge_with
    self.assert_same_rank(other)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 985, in assert_same_rank
    (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) must have the same rank

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 1015, in with_rank
    return self.merge_with(unknown_shape(rank=rank))
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 936, in merge_with
    raise ValueError("Shapes %s and %s are not compatible" % (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) are not compatible

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/ops/nn_ops.py", line 1039, in __init__
    input_shape.with_rank(num_spatial_dims + 2)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 1017, in with_rank
    raise ValueError("Shape %s must have rank %d" % (self, rank))
ValueError: Shape (32, 10) must have rank 4

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 53, in process_tensor
    result = self.model.process_data(parsed)
  File "inference.py", line 109, in process_data
    result = self.model(input_data)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/sequential.py", line 277, in call
    return super(Sequential, self).call(inputs, training=training, mask=mask)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/network.py", line 719, in call
    convert_kwargs_to_constants=base_layer_utils.call_context().saving)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/network.py", line 888, in _run_internal_graph
    output_tensors = layer(computed_tensors, **kwargs)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/layers/convolutional.py", line 201, in call
    data_format=self._conv_op_data_format)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/ops/nn_ops.py", line 1042, in __init__
    "input tensor must have rank %d" % (num_spatial_dims + 2))
ValueError: input tensor must have rank 4
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7f91a80e8d08>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: input tensor must have rank 4"
	debug_error_string = "{"created":"@1592902237.167208596","description":"Error received from peer ipv6:[::1]:50053","file":"src/core/lib/surface/call.cc","file_line":1056,"grpc_message":"Exception calling application: input tensor must have rank 4","grpc_status":2}"
>
WARNING:tensorflow:Model was constructed with shape (None, 28, 28, 1) for input Tensor("conv2d_input:0", shape=(None, 28, 28, 1), dtype=float32), but it was called on an input with incompatible shape (32, 10).
ERROR:grpc._server:Exception calling application: input tensor must have rank 4
Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 930, in merge_with
    self.assert_same_rank(other)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 985, in assert_same_rank
    (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) must have the same rank

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 1015, in with_rank
    return self.merge_with(unknown_shape(rank=rank))
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 936, in merge_with
    raise ValueError("Shapes %s and %s are not compatible" % (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) are not compatible

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/ops/nn_ops.py", line 1039, in __init__
    input_shape.with_rank(num_spatial_dims + 2)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 1017, in with_rank
    raise ValueError("Shape %s must have rank %d" % (self, rank))
ValueError: Shape (32, 10) must have rank 4

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 53, in process_tensor
    result = self.model.process_data(parsed)
  File "inference.py", line 109, in process_data
    result = self.model(input_data)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/sequential.py", line 277, in call
    return super(Sequential, self).call(inputs, training=training, mask=mask)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/network.py", line 719, in call
    convert_kwargs_to_constants=base_layer_utils.call_context().saving)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/network.py", line 888, in _run_internal_graph
    output_tensors = layer(computed_tensors, **kwargs)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/layers/convolutional.py", line 201, in call
    data_format=self._conv_op_data_format)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/ops/nn_ops.py", line 1042, in __init__
    "input tensor must have rank %d" % (num_spatial_dims + 2))
ValueError: input tensor must have rank 4
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7f91a80ab620>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: input tensor must have rank 4"
	debug_error_string = "{"created":"@1592902238.176624147","description":"Error received from peer ipv6:[::1]:50053","file":"src/core/lib/surface/call.cc","file_line":1056,"grpc_message":"Exception calling application: input tensor must have rank 4","grpc_status":2}"
>
WARNING:tensorflow:Model was constructed with shape (None, 28, 28, 1) for input Tensor("conv2d_input:0", shape=(None, 28, 28, 1), dtype=float32), but it was called on an input with incompatible shape (32, 10).
ERROR:grpc._server:Exception calling application: input tensor must have rank 4
Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 930, in merge_with
    self.assert_same_rank(other)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 985, in assert_same_rank
    (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) must have the same rank

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 1015, in with_rank
    return self.merge_with(unknown_shape(rank=rank))
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 936, in merge_with
    raise ValueError("Shapes %s and %s are not compatible" % (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) are not compatible

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/ops/nn_ops.py", line 1039, in __init__
    input_shape.with_rank(num_spatial_dims + 2)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/tensor_shape.py", line 1017, in with_rank
    raise ValueError("Shape %s must have rank %d" % (self, rank))
ValueError: Shape (32, 10) must have rank 4

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 53, in process_tensor
    result = self.model.process_data(parsed)
  File "inference.py", line 109, in process_data
    result = self.model(input_data)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/sequential.py", line 277, in call
    return super(Sequential, self).call(inputs, training=training, mask=mask)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/network.py", line 719, in call
    convert_kwargs_to_constants=base_layer_utils.call_context().saving)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/network.py", line 888, in _run_internal_graph
    output_tensors = layer(computed_tensors, **kwargs)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/layers/convolutional.py", line 201, in call
    data_format=self._conv_op_data_format)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/ops/nn_ops.py", line 1042, in __init__
    "input tensor must have rank %d" % (num_spatial_dims + 2))
ValueError: input tensor must have rank 4
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7f91a817d8c8>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: input tensor must have rank 4"
	debug_error_string = "{"created":"@1592902239.194362856","description":"Error received from peer ipv6:[::1]:50053","file":"src/core/lib/surface/call.cc","file_line":1056,"grpc_message":"Exception calling application: input tensor must have rank 4","grpc_status":2}"
>
INFO:root:predictions: [7, 2, 1, 0, 4, 1, 4, 9, 5, 9, 0, 6, 9, 0, 1, 5, 9, 7, 8, 4, 9, 6, 6, 5, 4, 0, 7, 4, 0, 1, 3, 1]
INFO:root:labels: [7 2 1 0 4 1 4 9 5 9 0 6 9 0 1 5 9 7 3 4 9 6 6 5 4 0 7 4 0 1 3 1]
INFO:root:test loss: 0.048442352563142776, test accuracy: 0.96875
INFO:root:predictions: [3, 4, 7, 2, 7, 1, 2, 1, 1, 7, 4, 2, 3, 5, 1, 2, 4, 4, 6, 3, 5, 5, 6, 0, 4, 1, 9, 5, 7, 8, 9, 3]
INFO:root:labels: [3 4 7 2 7 1 2 1 1 7 4 2 3 5 1 2 4 4 6 3 5 5 6 0 4 1 9 5 7 8 9 3]
INFO:root:test loss: 0.03394612297415733, test accuracy: 0.984375
INFO:root:predictions: [7, 4, 6, 4, 3, 0, 7, 0, 2, 9, 1, 7, 3, 2, 9, 7, 7, 6, 2, 7, 8, 4, 7, 3, 6, 1, 3, 6, 9, 3, 1, 4]
INFO:root:labels: [7 4 6 4 3 0 7 0 2 9 1 7 3 2 9 7 7 6 2 7 8 4 7 3 6 1 3 6 9 3 1 4]
INFO:root:test loss: 0.025930166244506836, test accuracy: 0.9895833134651184
INFO:root:predictions: [1, 7, 6, 9, 6, 0, 5, 4, 9, 9, 2, 1, 9, 4, 8, 7, 3, 9, 7, 4, 4, 4, 9, 2, 5, 4, 7, 6, 4, 9, 0, 5]
INFO:root:labels: [1 7 6 9 6 0 5 4 9 9 2 1 9 4 8 7 3 9 7 4 4 4 9 2 5 4 7 6 7 9 0 5]
INFO:root:test loss: 0.029725471511483192, test accuracy: 0.984375
INFO:root:predictions: [8, 5, 6, 6, 5, 7, 8, 1, 0, 1, 6, 4, 6, 7, 3, 1, 7, 1, 8, 2, 0, 2, 9, 9, 5, 5, 1, 5, 6, 0, 3, 4]
INFO:root:labels: [8 5 6 6 5 7 8 1 0 1 6 4 6 7 3 1 7 1 8 2 0 2 9 9 5 5 1 5 6 0 3 4]
INFO:root:test loss: 0.03055626153945923, test accuracy: 0.987500011920929
INFO:root:predictions: [7, 2, 1, 0, 4, 1, 4, 9, 5, 9, 0, 6, 9, 0, 1, 5, 9, 7, 5, 4, 9, 6, 6, 5, 4, 0, 7, 4, 0, 1, 3, 1]
INFO:root:labels: [7 2 1 0 4 1 4 9 5 9 0 6 9 0 1 5 9 7 3 4 9 6 6 5 4 0 7 4 0 1 3 1]
INFO:root:test loss: 0.047632910311222076, test accuracy: 0.96875
INFO:root:predictions: [3, 4, 7, 2, 7, 1, 2, 1, 1, 7, 4, 2, 3, 5, 1, 2, 4, 4, 6, 3, 5, 5, 6, 0, 4, 1, 9, 5, 7, 8, 9, 3]
INFO:root:labels: [3 4 7 2 7 1 2 1 1 7 4 2 3 5 1 2 4 4 6 3 5 5 6 0 4 1 9 5 7 8 9 3]
INFO:root:test loss: 0.030069991946220398, test accuracy: 0.984375
INFO:root:predictions: [7, 4, 6, 4, 3, 0, 7, 0, 2, 9, 1, 7, 3, 2, 9, 7, 7, 6, 2, 7, 8, 4, 7, 3, 6, 1, 3, 6, 9, 3, 1, 4]
INFO:root:labels: [7 4 6 4 3 0 7 0 2 9 1 7 3 2 9 7 7 6 2 7 8 4 7 3 6 1 3 6 9 3 1 4]
INFO:root:test loss: 0.022749217227101326, test accuracy: 0.9895833134651184
INFO:root:predictions: [1, 7, 6, 9, 6, 0, 5, 4, 9, 9, 2, 1, 9, 4, 8, 7, 3, 9, 7, 9, 4, 4, 9, 2, 5, 4, 7, 6, 7, 9, 0, 5]
INFO:root:labels: [1 7 6 9 6 0 5 4 9 9 2 1 9 4 8 7 3 9 7 4 4 4 9 2 5 4 7 6 7 9 0 5]
INFO:root:test loss: 0.0307793989777565, test accuracy: 0.984375
INFO:root:predictions: [8, 5, 6, 6, 5, 7, 8, 1, 0, 1, 6, 4, 6, 7, 3, 1, 7, 1, 8, 2, 0, 2, 9, 9, 5, 5, 1, 5, 6, 0, 3, 4]
INFO:root:labels: [8 5 6 6 5 7 8 1 0 1 6 4 6 7 3 1 7 1 8 2 0 2 9 9 5 5 1 5 6 0 3 4]
INFO:root:test loss: 0.027642112225294113, test accuracy: 0.987500011920929
INFO:root:predictions: [7, 2, 1, 0, 4, 1, 4, 9, 5, 9, 0, 6, 9, 0, 1, 5, 9, 7, 5, 4, 9, 6, 6, 5, 4, 0, 7, 4, 0, 1, 3, 1]
INFO:root:labels: [7 2 1 0 4 1 4 9 5 9 0 6 9 0 1 5 9 7 3 4 9 6 6 5 4 0 7 4 0 1 3 1]
INFO:root:test loss: 0.061450421810150146, test accuracy: 0.96875
INFO:root:predictions: [3, 4, 7, 2, 7, 1, 2, 1, 1, 7, 4, 2, 3, 5, 1, 2, 4, 4, 6, 3, 5, 5, 6, 0, 4, 1, 9, 5, 7, 8, 9, 3]
INFO:root:labels: [3 4 7 2 7 1 2 1 1 7 4 2 3 5 1 2 4 4 6 3 5 5 6 0 4 1 9 5 7 8 9 3]
INFO:root:test loss: 0.03442780673503876, test accuracy: 0.984375
INFO:root:predictions: [7, 4, 6, 4, 3, 0, 7, 0, 2, 9, 1, 7, 3, 2, 9, 7, 7, 6, 2, 7, 8, 4, 7, 3, 6, 1, 3, 6, 9, 3, 1, 4]
INFO:root:labels: [7 4 6 4 3 0 7 0 2 9 1 7 3 2 9 7 7 6 2 7 8 4 7 3 6 1 3 6 9 3 1 4]
INFO:root:test loss: 0.02329305000603199, test accuracy: 0.9895833134651184
INFO:root:predictions: [1, 7, 6, 9, 6, 0, 5, 4, 9, 9, 2, 1, 9, 4, 8, 7, 3, 9, 7, 4, 4, 4, 9, 2, 5, 4, 7, 6, 7, 9, 0, 5]
INFO:root:labels: [1 7 6 9 6 0 5 4 9 9 2 1 9 4 8 7 3 9 7 4 4 4 9 2 5 4 7 6 7 9 0 5]
INFO:root:test loss: 0.018317589536309242, test accuracy: 0.9921875
INFO:root:predictions: [8, 5, 6, 6, 5, 7, 8, 1, 0, 1, 6, 4, 6, 7, 3, 1, 7, 1, 8, 2, 0, 2, 9, 9, 5, 5, 1, 5, 6, 0, 5, 4]
INFO:root:labels: [8 5 6 6 5 7 8 1 0 1 6 4 6 7 3 1 7 1 8 2 0 2 9 9 5 5 1 5 6 0 3 4]
INFO:root:test loss: 0.029619818553328514, test accuracy: 0.987500011920929
ERROR:grpc._server:Exception calling application: name 'processing_overhead' is not defined
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 81, in test_process
    time_delta *= processing_overhead
NameError: name 'processing_overhead' is not defined
INFO:root:predictions: [7, 2, 1, 0, 4, 1, 4, 9, 5, 9, 0, 6, 9, 0, 1, 5, 9, 7, 5, 4, 9, 6, 6, 5, 4, 0, 7, 4, 0, 1, 3, 1]
INFO:root:labels: [7 2 1 0 4 1 4 9 5 9 0 6 9 0 1 5 9 7 3 4 9 6 6 5 4 0 7 4 0 1 3 1]
INFO:root:test loss: 0.061450421810150146, test accuracy: 0.96875
INFO:root:predictions: [3, 4, 7, 2, 7, 1, 2, 1, 1, 7, 4, 2, 3, 5, 1, 2, 4, 4, 6, 3, 5, 5, 6, 0, 4, 1, 9, 5, 7, 8, 9, 3]
INFO:root:labels: [3 4 7 2 7 1 2 1 1 7 4 2 3 5 1 2 4 4 6 3 5 5 6 0 4 1 9 5 7 8 9 3]
INFO:root:test loss: 0.03442780673503876, test accuracy: 0.984375
INFO:root:predictions: [7, 4, 6, 4, 3, 0, 7, 0, 2, 9, 1, 7, 3, 2, 9, 7, 7, 6, 2, 7, 8, 4, 7, 3, 6, 1, 3, 6, 9, 3, 1, 4]
INFO:root:labels: [7 4 6 4 3 0 7 0 2 9 1 7 3 2 9 7 7 6 2 7 8 4 7 3 6 1 3 6 9 3 1 4]
INFO:root:test loss: 0.02329305000603199, test accuracy: 0.9895833134651184
INFO:root:predictions: [1, 7, 6, 9, 6, 0, 5, 4, 9, 9, 2, 1, 9, 4, 8, 7, 3, 9, 7, 4, 4, 4, 9, 2, 5, 4, 7, 6, 7, 9, 0, 5]
INFO:root:labels: [1 7 6 9 6 0 5 4 9 9 2 1 9 4 8 7 3 9 7 4 4 4 9 2 5 4 7 6 7 9 0 5]
INFO:root:test loss: 0.018317589536309242, test accuracy: 0.9921875
INFO:root:predictions: [8, 5, 6, 6, 5, 7, 8, 1, 0, 1, 6, 4, 6, 7, 3, 1, 7, 1, 8, 2, 0, 2, 9, 9, 5, 5, 1, 5, 6, 0, 5, 4]
INFO:root:labels: [8 5 6 6 5 7 8 1 0 1 6 4 6 7 3 1 7 1 8 2 0 2 9 9 5 5 1 5 6 0 3 4]
INFO:root:test loss: 0.029619818553328514, test accuracy: 0.987500011920929
INFO:root:predictions: [7, 2, 1, 0, 4, 1, 4, 9, 5, 9, 0, 6, 9, 0, 1, 5, 9, 7, 5, 4, 9, 6, 6, 5, 4, 0, 7, 4, 0, 1, 3, 1]
INFO:root:labels: [7 2 1 0 4 1 4 9 5 9 0 6 9 0 1 5 9 7 3 4 9 6 6 5 4 0 7 4 0 1 3 1]
INFO:root:test loss: 0.061450421810150146, test accuracy: 0.96875
INFO:root:predictions: [3, 4, 7, 2, 7, 1, 2, 1, 1, 7, 4, 2, 3, 5, 1, 2, 4, 4, 6, 3, 5, 5, 6, 0, 4, 1, 9, 5, 7, 8, 9, 3]
INFO:root:labels: [3 4 7 2 7 1 2 1 1 7 4 2 3 5 1 2 4 4 6 3 5 5 6 0 4 1 9 5 7 8 9 3]
INFO:root:test loss: 0.03442780673503876, test accuracy: 0.984375
INFO:root:predictions: [7, 4, 6, 4, 3, 0, 7, 0, 2, 9, 1, 7, 3, 2, 9, 7, 7, 6, 2, 7, 8, 4, 7, 3, 6, 1, 3, 6, 9, 3, 1, 4]
INFO:root:labels: [7 4 6 4 3 0 7 0 2 9 1 7 3 2 9 7 7 6 2 7 8 4 7 3 6 1 3 6 9 3 1 4]
INFO:root:test loss: 0.02329305000603199, test accuracy: 0.9895833134651184
INFO:root:predictions: [1, 7, 6, 9, 6, 0, 5, 4, 9, 9, 2, 1, 9, 4, 8, 7, 3, 9, 7, 4, 4, 4, 9, 2, 5, 4, 7, 6, 7, 9, 0, 5]
INFO:root:labels: [1 7 6 9 6 0 5 4 9 9 2 1 9 4 8 7 3 9 7 4 4 4 9 2 5 4 7 6 7 9 0 5]
INFO:root:test loss: 0.018317589536309242, test accuracy: 0.9921875
INFO:root:predictions: [8, 5, 6, 6, 5, 7, 8, 1, 0, 1, 6, 4, 6, 7, 3, 1, 7, 1, 8, 2, 0, 2, 9, 9, 5, 5, 1, 5, 6, 0, 5, 4]
INFO:root:labels: [8 5 6 6 5 7 8 1 0 1 6 4 6 7 3 1 7 1 8 2 0 2 9 9 5 5 1 5 6 0 3 4]
INFO:root:test loss: 0.029619818553328514, test accuracy: 0.987500011920929
ERROR:grpc._server:Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 65, in process_tensor
    parsed = parse(full_data)
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2160, in parse_tensor
    _ops.raise_from_not_ok_status(e, name)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 6653, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fee24156050>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]"
	debug_error_string = "{"created":"@1593482457.490109427","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 65, in process_tensor
    parsed = parse(full_data)
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2160, in parse_tensor
    _ops.raise_from_not_ok_status(e, name)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 6653, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fee5cb3ad40>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]"
	debug_error_string = "{"created":"@1593482458.497134036","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 65, in process_tensor
    parsed = parse(full_data)
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2160, in parse_tensor
    _ops.raise_from_not_ok_status(e, name)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 6653, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fee5cb03a70>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]"
	debug_error_string = "{"created":"@1593482459.502973221","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 65, in process_tensor
    parsed = parse(full_data)
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2160, in parse_tensor
    _ops.raise_from_not_ok_status(e, name)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 6653, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fee240e3dd0>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]"
	debug_error_string = "{"created":"@1593482460.509756177","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 65, in process_tensor
    parsed = parse(full_data)
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2160, in parse_tensor
    _ops.raise_from_not_ok_status(e, name)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 6653, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fee241565f0>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]"
	debug_error_string = "{"created":"@1593482461.518283823","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: 'utf-8' codec can't decode byte 0xa0 in position 48: invalid start byte
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 65, in process_tensor
    parsed = parse(full_data)
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2144, in parse_tensor
    tld.op_callbacks, serialized, "out_type", out_type)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa0 in position 48: invalid start byte
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7f1f085f7950>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: 'utf-8' codec can't decode byte 0xa0 in position 48: invalid start byte"
	debug_error_string = "{"created":"@1593482573.282988780","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: 'utf-8' codec can't decode byte 0xa0 in position 48: invalid start byte","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: 'utf-8' codec can't decode byte 0x9a in position 49: invalid start byte
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 65, in process_tensor
    parsed = parse(full_data)
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2144, in parse_tensor
    tld.op_callbacks, serialized, "out_type", out_type)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x9a in position 49: invalid start byte
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7f1ed04f2f80>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: 'utf-8' codec can't decode byte 0x9a in position 49: invalid start byte"
	debug_error_string = "{"created":"@1593482574.289329818","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: 'utf-8' codec can't decode byte 0x9a in position 49: invalid start byte","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 65, in process_tensor
    parsed = parse(full_data)
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2160, in parse_tensor
    _ops.raise_from_not_ok_status(e, name)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 6653, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7f1f085f7320>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]"
	debug_error_string = "{"created":"@1593482575.292019250","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: 'utf-8' codec can't decode byte 0xb8 in position 48: invalid start byte
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 65, in process_tensor
    parsed = parse(full_data)
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2144, in parse_tensor
    tld.op_callbacks, serialized, "out_type", out_type)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb8 in position 48: invalid start byte
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7f1ed04f24d0>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: 'utf-8' codec can't decode byte 0xb8 in position 48: invalid start byte"
	debug_error_string = "{"created":"@1593482576.294835340","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: 'utf-8' codec can't decode byte 0xb8 in position 48: invalid start byte","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: 'utf-8' codec can't decode byte 0xcc in position 47: invalid continuation byte
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 65, in process_tensor
    parsed = parse(full_data)
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2144, in parse_tensor
    tld.op_callbacks, serialized, "out_type", out_type)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xcc in position 47: invalid continuation byte
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7f1f085f7320>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: 'utf-8' codec can't decode byte 0xcc in position 47: invalid continuation byte"
	debug_error_string = "{"created":"@1593482577.294853401","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: 'utf-8' codec can't decode byte 0xcc in position 47: invalid continuation byte","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 65, in process_tensor
    self.queue_single_inference = []
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2160, in parse_tensor
    _ops.raise_from_not_ok_status(e, name)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 6653, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fb61832e170>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]"
	debug_error_string = "{"created":"@1593482832.971299001","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 65, in process_tensor
    self.queue_single_inference = []
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2160, in parse_tensor
    _ops.raise_from_not_ok_status(e, name)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 6653, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fb64d633d40>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]"
	debug_error_string = "{"created":"@1593482833.979215393","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 65, in process_tensor
    self.queue_single_inference = []
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2160, in parse_tensor
    _ops.raise_from_not_ok_status(e, name)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 6653, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fb61832e7a0>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]"
	debug_error_string = "{"created":"@1593482834.981921281","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 65, in process_tensor
    self.queue_single_inference = []
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2160, in parse_tensor
    _ops.raise_from_not_ok_status(e, name)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 6653, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fb61823cb00>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]"
	debug_error_string = "{"created":"@1593482835.990805269","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 65, in process_tensor
    self.queue_single_inference = []
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2160, in parse_tensor
    _ops.raise_from_not_ok_status(e, name)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 6653, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fb61823cb00>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]"
	debug_error_string = "{"created":"@1593482836.995851181","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 67, in process_tensor
    parsed = parse(full_data)
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2160, in parse_tensor
    _ops.raise_from_not_ok_status(e, name)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 6653, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fb618252cb0>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]"
	debug_error_string = "{"created":"@1593483197.803048028","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 67, in process_tensor
    parsed = parse(full_data)
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2160, in parse_tensor
    _ops.raise_from_not_ok_status(e, name)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 6653, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fb618245b90>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]"
	debug_error_string = "{"created":"@1593483198.809774103","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 67, in process_tensor
    parsed = parse(full_data)
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2160, in parse_tensor
    _ops.raise_from_not_ok_status(e, name)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 6653, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fb61822f680>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]"
	debug_error_string = "{"created":"@1593483199.815321238","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 67, in process_tensor
    parsed = parse(full_data)
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2160, in parse_tensor
    _ops.raise_from_not_ok_status(e, name)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 6653, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fb61822f9e0>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]"
	debug_error_string = "{"created":"@1593483200.819765394","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 67, in process_tensor
    parsed = parse(full_data)
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2160, in parse_tensor
    _ops.raise_from_not_ok_status(e, name)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 6653, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fb61822f710>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]"
	debug_error_string = "{"created":"@1593483201.825582176","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]","grpc_status":2}"
>
INFO:root:predictions: [7, 2, 1, 0, 4, 1, 4, 9, 5, 9, 0, 6, 9, 0, 1, 5, 9, 7, 5, 4, 9, 6, 6, 5, 4, 0, 7, 4, 0, 1, 3, 1]
INFO:root:labels: [7 2 1 0 4 1 4 9 5 9 0 6 9 0 1 5 9 7 3 4 9 6 6 5 4 0 7 4 0 1 3 1]
INFO:root:test loss: 0.061450421810150146, test accuracy: 0.96875
INFO:root:predictions: [3, 4, 7, 2, 7, 1, 2, 1, 1, 7, 4, 2, 3, 5, 1, 2, 4, 4, 6, 3, 5, 5, 6, 0, 4, 1, 9, 5, 7, 8, 9, 3]
INFO:root:labels: [3 4 7 2 7 1 2 1 1 7 4 2 3 5 1 2 4 4 6 3 5 5 6 0 4 1 9 5 7 8 9 3]
INFO:root:test loss: 0.03442780673503876, test accuracy: 0.984375
INFO:root:predictions: [7, 4, 6, 4, 3, 0, 7, 0, 2, 9, 1, 7, 3, 2, 9, 7, 7, 6, 2, 7, 8, 4, 7, 3, 6, 1, 3, 6, 9, 3, 1, 4]
INFO:root:labels: [7 4 6 4 3 0 7 0 2 9 1 7 3 2 9 7 7 6 2 7 8 4 7 3 6 1 3 6 9 3 1 4]
INFO:root:test loss: 0.02329305000603199, test accuracy: 0.9895833134651184
INFO:root:predictions: [1, 7, 6, 9, 6, 0, 5, 4, 9, 9, 2, 1, 9, 4, 8, 7, 3, 9, 7, 4, 4, 4, 9, 2, 5, 4, 7, 6, 7, 9, 0, 5]
INFO:root:labels: [1 7 6 9 6 0 5 4 9 9 2 1 9 4 8 7 3 9 7 4 4 4 9 2 5 4 7 6 7 9 0 5]
INFO:root:test loss: 0.018317589536309242, test accuracy: 0.9921875
INFO:root:predictions: [8, 5, 6, 6, 5, 7, 8, 1, 0, 1, 6, 4, 6, 7, 3, 1, 7, 1, 8, 2, 0, 2, 9, 9, 5, 5, 1, 5, 6, 0, 5, 4]
INFO:root:labels: [8 5 6 6 5 7 8 1 0 1 6 4 6 7 3 1 7 1 8 2 0 2 9 9 5 5 1 5 6 0 3 4]
INFO:root:test loss: 0.029619818553328514, test accuracy: 0.987500011920929
ERROR:grpc._server:Exception calling application: Could not parse `serialized` as TensorProto: '? [Op:ParseTensor]
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 67, in process_tensor
    parsed = parse(full_data)
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2160, in parse_tensor
    _ops.raise_from_not_ok_status(e, name)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 6653, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: Could not parse `serialized` as TensorProto: '? [Op:ParseTensor]
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fe118319e60>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: Could not parse `serialized` as TensorProto: '? [Op:ParseTensor]"
	debug_error_string = "{"created":"@1593483328.849386570","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: Could not parse `serialized` as TensorProto: '? [Op:ParseTensor]","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 67, in process_tensor
    parsed = parse(full_data)
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2160, in parse_tensor
    _ops.raise_from_not_ok_status(e, name)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 6653, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fe11823ae60>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]"
	debug_error_string = "{"created":"@1593483329.856961867","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 67, in process_tensor
    parsed = parse(full_data)
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2160, in parse_tensor
    _ops.raise_from_not_ok_status(e, name)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 6653, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fe14f43f320>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]"
	debug_error_string = "{"created":"@1593483330.859831141","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: Could not parse `serialized` as TensorProto: ' [Op:ParseTensor]","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: Could not parse `serialized` as TensorProto: '@ [Op:ParseTensor]
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 67, in process_tensor
    parsed = parse(full_data)
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2160, in parse_tensor
    _ops.raise_from_not_ok_status(e, name)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 6653, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: Could not parse `serialized` as TensorProto: '@ [Op:ParseTensor]
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fe1182280e0>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: Could not parse `serialized` as TensorProto: '@ [Op:ParseTensor]"
	debug_error_string = "{"created":"@1593483331.866474719","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: Could not parse `serialized` as TensorProto: '@ [Op:ParseTensor]","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: Could not parse `serialized` as TensorProto: '@ [Op:ParseTensor]
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 67, in process_tensor
    parsed = parse(full_data)
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2160, in parse_tensor
    _ops.raise_from_not_ok_status(e, name)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/ops.py", line 6653, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: Could not parse `serialized` as TensorProto: '@ [Op:ParseTensor]
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fe118224560>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: Could not parse `serialized` as TensorProto: '@ [Op:ParseTensor]"
	debug_error_string = "{"created":"@1593483332.868007045","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: Could not parse `serialized` as TensorProto: '@ [Op:ParseTensor]","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: 'utf-8' codec can't decode bytes in position 48-49: invalid continuation byte
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 68, in process_tensor
    parsed = parse(full_data)
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2144, in parse_tensor
    tld.op_callbacks, serialized, "out_type", out_type)
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 48-49: invalid continuation byte
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fbd4c7c9a70>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: 'utf-8' codec can't decode bytes in position 48-49: invalid continuation byte"
	debug_error_string = "{"created":"@1593483415.750073540","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: 'utf-8' codec can't decode bytes in position 48-49: invalid continuation byte","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: 'utf-8' codec can't decode bytes in position 48-49: invalid continuation byte
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 68, in process_tensor
    parsed = parse(full_data)
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2144, in parse_tensor
    tld.op_callbacks, serialized, "out_type", out_type)
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 48-49: invalid continuation byte
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fbd0c5c5200>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: 'utf-8' codec can't decode bytes in position 48-49: invalid continuation byte"
	debug_error_string = "{"created":"@1593483416.759779347","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: 'utf-8' codec can't decode bytes in position 48-49: invalid continuation byte","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: 'utf-8' codec can't decode bytes in position 48-49: invalid continuation byte
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 68, in process_tensor
    parsed = parse(full_data)
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2144, in parse_tensor
    tld.op_callbacks, serialized, "out_type", out_type)
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 48-49: invalid continuation byte
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fbd0c5c9290>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: 'utf-8' codec can't decode bytes in position 48-49: invalid continuation byte"
	debug_error_string = "{"created":"@1593483417.762795966","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: 'utf-8' codec can't decode bytes in position 48-49: invalid continuation byte","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: 'utf-8' codec can't decode bytes in position 48-49: invalid continuation byte
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 68, in process_tensor
    parsed = parse(full_data)
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2144, in parse_tensor
    tld.op_callbacks, serialized, "out_type", out_type)
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 48-49: invalid continuation byte
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fbd4c7c9b90>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: 'utf-8' codec can't decode bytes in position 48-49: invalid continuation byte"
	debug_error_string = "{"created":"@1593483418.761077014","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: 'utf-8' codec can't decode bytes in position 48-49: invalid continuation byte","grpc_status":2}"
>
ERROR:grpc._server:Exception calling application: 'utf-8' codec can't decode bytes in position 48-49: invalid continuation byte
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 68, in process_tensor
    parsed = parse(full_data)
  File "/home/root/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2144, in parse_tensor
    tld.op_callbacks, serialized, "out_type", out_type)
UnicodeDecodeError: 'utf-8' codec can't decode bytes in position 48-49: invalid continuation byte
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fbd0c5c8b90>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: 'utf-8' codec can't decode bytes in position 48-49: invalid continuation byte"
	debug_error_string = "{"created":"@1593483419.767114518","description":"Error received from peer ipv4:127.0.0.1:50052","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: 'utf-8' codec can't decode bytes in position 48-49: invalid continuation byte","grpc_status":2}"
>
INFO:root:predictions: [7, 2, 1, 0, 4, 1, 4, 9, 5, 9, 0, 6, 9, 0, 1, 5, 9, 7, 5, 4, 9, 6, 6, 5, 4, 0, 7, 4, 0, 1, 3, 1]
INFO:root:labels: [7 2 1 0 4 1 4 9 5 9 0 6 9 0 1 5 9 7 3 4 9 6 6 5 4 0 7 4 0 1 3 1]
INFO:root:test loss: 0.061450421810150146, test accuracy: 0.96875
INFO:root:predictions: [3, 4, 7, 2, 7, 1, 2, 1, 1, 7, 4, 2, 3, 5, 1, 2, 4, 4, 6, 3, 5, 5, 6, 0, 4, 1, 9, 5, 7, 8, 9, 3]
INFO:root:labels: [3 4 7 2 7 1 2 1 1 7 4 2 3 5 1 2 4 4 6 3 5 5 6 0 4 1 9 5 7 8 9 3]
INFO:root:test loss: 0.03442780673503876, test accuracy: 0.984375
INFO:root:predictions: [7, 4, 6, 4, 3, 0, 7, 0, 2, 9, 1, 7, 3, 2, 9, 7, 7, 6, 2, 7, 8, 4, 7, 3, 6, 1, 3, 6, 9, 3, 1, 4]
INFO:root:labels: [7 4 6 4 3 0 7 0 2 9 1 7 3 2 9 7 7 6 2 7 8 4 7 3 6 1 3 6 9 3 1 4]
INFO:root:test loss: 0.02329305000603199, test accuracy: 0.9895833134651184
INFO:root:predictions: [1, 7, 6, 9, 6, 0, 5, 4, 9, 9, 2, 1, 9, 4, 8, 7, 3, 9, 7, 4, 4, 4, 9, 2, 5, 4, 7, 6, 7, 9, 0, 5]
INFO:root:labels: [1 7 6 9 6 0 5 4 9 9 2 1 9 4 8 7 3 9 7 4 4 4 9 2 5 4 7 6 7 9 0 5]
INFO:root:test loss: 0.018317589536309242, test accuracy: 0.9921875
INFO:root:predictions: [8, 5, 6, 6, 5, 7, 8, 1, 0, 1, 6, 4, 6, 7, 3, 1, 7, 1, 8, 2, 0, 2, 9, 9, 5, 5, 1, 5, 6, 0, 5, 4]
INFO:root:labels: [8 5 6 6 5 7 8 1 0 1 6 4 6 7 3 1 7 1 8 2 0 2 9 9 5 5 1 5 6 0 3 4]
INFO:root:test loss: 0.029619818553328514, test accuracy: 0.987500011920929
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fdb720fcc20>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "failed to connect to all addresses"
	debug_error_string = "{"created":"@1593486304.398329819","description":"Failed to pick subchannel","file":"src/core/ext/filters/client_channel/client_channel.cc","file_line":3948,"referenced_errors":[{"created":"@1593486304.398320260","description":"failed to connect to all addresses","file":"src/core/ext/filters/client_channel/lb_policy/pick_first/pick_first.cc","file_line":394,"grpc_status":14}]}"
>
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fdb540b7680>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "failed to connect to all addresses"
	debug_error_string = "{"created":"@1593486304.398311887","description":"Failed to pick subchannel","file":"src/core/ext/filters/client_channel/client_channel.cc","file_line":3948,"referenced_errors":[{"created":"@1593486304.398302078","description":"failed to connect to all addresses","file":"src/core/ext/filters/client_channel/lb_policy/pick_first/pick_first.cc","file_line":394,"grpc_status":14}]}"
>
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fdb7211d3b0>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "failed to connect to all addresses"
	debug_error_string = "{"created":"@1593486304.398285128","description":"Failed to pick subchannel","file":"src/core/ext/filters/client_channel/client_channel.cc","file_line":3948,"referenced_errors":[{"created":"@1593486304.398271824","description":"failed to connect to all addresses","file":"src/core/ext/filters/client_channel/lb_policy/pick_first/pick_first.cc","file_line":394,"grpc_status":14}]}"
>
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fdb720fca70>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "failed to connect to all addresses"
	debug_error_string = "{"created":"@1593486304.398353463","description":"Failed to pick subchannel","file":"src/core/ext/filters/client_channel/client_channel.cc","file_line":3948,"referenced_errors":[{"created":"@1593486304.398343782","description":"failed to connect to all addresses","file":"src/core/ext/filters/client_channel/lb_policy/pick_first/pick_first.cc","file_line":394,"grpc_status":14}]}"
>
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fdb7211ac20>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNAVAILABLE
	details = "failed to connect to all addresses"
	debug_error_string = "{"created":"@1593486304.398371157","description":"Failed to pick subchannel","file":"src/core/ext/filters/client_channel/client_channel.cc","file_line":3948,"referenced_errors":[{"created":"@1593486304.398361461","description":"failed to connect to all addresses","file":"src/core/ext/filters/client_channel/lb_policy/pick_first/pick_first.cc","file_line":394,"grpc_status":14}]}"
>
WARNING:tensorflow:Model was constructed with shape (None, 28, 28, 1) for input Tensor("conv2d_input:0", shape=(None, 28, 28, 1), dtype=float32), but it was called on an input with incompatible shape (32, 10).
ERROR:grpc._server:Exception calling application: input tensor must have rank 4
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 930, in merge_with
    self.assert_same_rank(other)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 985, in assert_same_rank
    (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) must have the same rank

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 1015, in with_rank
    return self.merge_with(unknown_shape(rank=rank))
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 936, in merge_with
    raise ValueError("Shapes %s and %s are not compatible" % (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) are not compatible

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/nn_ops.py", line 1039, in __init__
    input_shape.with_rank(num_spatial_dims + 2)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 1017, in with_rank
    raise ValueError("Shape %s must have rank %d" % (self, rank))
ValueError: Shape (32, 10) must have rank 4

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 70, in process_tensor
    result = self.model.process_data(parsed)
  File "inference.py", line 127, in process_data
    result = self.model(input_data)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/sequential.py", line 277, in call
    return super(Sequential, self).call(inputs, training=training, mask=mask)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/network.py", line 719, in call
    convert_kwargs_to_constants=base_layer_utils.call_context().saving)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/network.py", line 888, in _run_internal_graph
    output_tensors = layer(computed_tensors, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/layers/convolutional.py", line 201, in call
    data_format=self._conv_op_data_format)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/nn_ops.py", line 1042, in __init__
    "input tensor must have rank %d" % (num_spatial_dims + 2))
ValueError: input tensor must have rank 4
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fdf32a8aa70>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: input tensor must have rank 4"
	debug_error_string = "{"created":"@1593486336.747592251","description":"Error received from peer ipv4:172.19.0.3:50051","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: input tensor must have rank 4","grpc_status":2}"
>
WARNING:tensorflow:Model was constructed with shape (None, 28, 28, 1) for input Tensor("conv2d_input:0", shape=(None, 28, 28, 1), dtype=float32), but it was called on an input with incompatible shape (32, 10).
ERROR:grpc._server:Exception calling application: input tensor must have rank 4
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 930, in merge_with
    self.assert_same_rank(other)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 985, in assert_same_rank
    (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) must have the same rank

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 1015, in with_rank
    return self.merge_with(unknown_shape(rank=rank))
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 936, in merge_with
    raise ValueError("Shapes %s and %s are not compatible" % (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) are not compatible

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/nn_ops.py", line 1039, in __init__
    input_shape.with_rank(num_spatial_dims + 2)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 1017, in with_rank
    raise ValueError("Shape %s must have rank %d" % (self, rank))
ValueError: Shape (32, 10) must have rank 4

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 70, in process_tensor
    result = self.model.process_data(parsed)
  File "inference.py", line 127, in process_data
    result = self.model(input_data)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/sequential.py", line 277, in call
    return super(Sequential, self).call(inputs, training=training, mask=mask)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/network.py", line 719, in call
    convert_kwargs_to_constants=base_layer_utils.call_context().saving)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/network.py", line 888, in _run_internal_graph
    output_tensors = layer(computed_tensors, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/layers/convolutional.py", line 201, in call
    data_format=self._conv_op_data_format)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/nn_ops.py", line 1042, in __init__
    "input tensor must have rank %d" % (num_spatial_dims + 2))
ValueError: input tensor must have rank 4
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fdf32a8a9e0>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: input tensor must have rank 4"
	debug_error_string = "{"created":"@1593486337.739502311","description":"Error received from peer ipv4:172.19.0.3:50051","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: input tensor must have rank 4","grpc_status":2}"
>
WARNING:tensorflow:Model was constructed with shape (None, 28, 28, 1) for input Tensor("conv2d_input:0", shape=(None, 28, 28, 1), dtype=float32), but it was called on an input with incompatible shape (32, 10).
ERROR:grpc._server:Exception calling application: input tensor must have rank 4
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 930, in merge_with
    self.assert_same_rank(other)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 985, in assert_same_rank
    (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) must have the same rank

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 1015, in with_rank
    return self.merge_with(unknown_shape(rank=rank))
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 936, in merge_with
    raise ValueError("Shapes %s and %s are not compatible" % (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) are not compatible

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/nn_ops.py", line 1039, in __init__
    input_shape.with_rank(num_spatial_dims + 2)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 1017, in with_rank
    raise ValueError("Shape %s must have rank %d" % (self, rank))
ValueError: Shape (32, 10) must have rank 4

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 70, in process_tensor
    result = self.model.process_data(parsed)
  File "inference.py", line 127, in process_data
    result = self.model(input_data)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/sequential.py", line 277, in call
    return super(Sequential, self).call(inputs, training=training, mask=mask)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/network.py", line 719, in call
    convert_kwargs_to_constants=base_layer_utils.call_context().saving)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/network.py", line 888, in _run_internal_graph
    output_tensors = layer(computed_tensors, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/layers/convolutional.py", line 201, in call
    data_format=self._conv_op_data_format)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/nn_ops.py", line 1042, in __init__
    "input tensor must have rank %d" % (num_spatial_dims + 2))
ValueError: input tensor must have rank 4
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fdf32aa5050>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: input tensor must have rank 4"
	debug_error_string = "{"created":"@1593486338.754845661","description":"Error received from peer ipv4:172.19.0.3:50051","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: input tensor must have rank 4","grpc_status":2}"
>
WARNING:tensorflow:Model was constructed with shape (None, 28, 28, 1) for input Tensor("conv2d_input:0", shape=(None, 28, 28, 1), dtype=float32), but it was called on an input with incompatible shape (32, 10).
ERROR:grpc._server:Exception calling application: input tensor must have rank 4
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 930, in merge_with
    self.assert_same_rank(other)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 985, in assert_same_rank
    (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) must have the same rank

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 1015, in with_rank
    return self.merge_with(unknown_shape(rank=rank))
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 936, in merge_with
    raise ValueError("Shapes %s and %s are not compatible" % (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) are not compatible

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/nn_ops.py", line 1039, in __init__
    input_shape.with_rank(num_spatial_dims + 2)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 1017, in with_rank
    raise ValueError("Shape %s must have rank %d" % (self, rank))
ValueError: Shape (32, 10) must have rank 4

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 70, in process_tensor
    result = self.model.process_data(parsed)
  File "inference.py", line 127, in process_data
    result = self.model(input_data)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/sequential.py", line 277, in call
    return super(Sequential, self).call(inputs, training=training, mask=mask)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/network.py", line 719, in call
    convert_kwargs_to_constants=base_layer_utils.call_context().saving)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/network.py", line 888, in _run_internal_graph
    output_tensors = layer(computed_tensors, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/layers/convolutional.py", line 201, in call
    data_format=self._conv_op_data_format)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/nn_ops.py", line 1042, in __init__
    "input tensor must have rank %d" % (num_spatial_dims + 2))
ValueError: input tensor must have rank 4
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fdf32aabb00>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: input tensor must have rank 4"
	debug_error_string = "{"created":"@1593486339.750559314","description":"Error received from peer ipv4:172.19.0.3:50051","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: input tensor must have rank 4","grpc_status":2}"
>
WARNING:tensorflow:Model was constructed with shape (None, 28, 28, 1) for input Tensor("conv2d_input:0", shape=(None, 28, 28, 1), dtype=float32), but it was called on an input with incompatible shape (32, 10).
ERROR:grpc._server:Exception calling application: input tensor must have rank 4
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 930, in merge_with
    self.assert_same_rank(other)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 985, in assert_same_rank
    (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) must have the same rank

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 1015, in with_rank
    return self.merge_with(unknown_shape(rank=rank))
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 936, in merge_with
    raise ValueError("Shapes %s and %s are not compatible" % (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) are not compatible

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/nn_ops.py", line 1039, in __init__
    input_shape.with_rank(num_spatial_dims + 2)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 1017, in with_rank
    raise ValueError("Shape %s must have rank %d" % (self, rank))
ValueError: Shape (32, 10) must have rank 4

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 70, in process_tensor
    result = self.model.process_data(parsed)
  File "inference.py", line 127, in process_data
    result = self.model(input_data)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/sequential.py", line 277, in call
    return super(Sequential, self).call(inputs, training=training, mask=mask)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/network.py", line 719, in call
    convert_kwargs_to_constants=base_layer_utils.call_context().saving)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/network.py", line 888, in _run_internal_graph
    output_tensors = layer(computed_tensors, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/layers/convolutional.py", line 201, in call
    data_format=self._conv_op_data_format)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/nn_ops.py", line 1042, in __init__
    "input tensor must have rank %d" % (num_spatial_dims + 2))
ValueError: input tensor must have rank 4
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fdf32ab00e0>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: input tensor must have rank 4"
	debug_error_string = "{"created":"@1593486340.753729849","description":"Error received from peer ipv4:172.19.0.3:50051","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: input tensor must have rank 4","grpc_status":2}"
>
WARNING:tensorflow:Model was constructed with shape (None, 28, 28, 1) for input Tensor("conv2d_input:0", shape=(None, 28, 28, 1), dtype=float32), but it was called on an input with incompatible shape (32, 10).
ERROR:grpc._server:Exception calling application: input tensor must have rank 4
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 930, in merge_with
    self.assert_same_rank(other)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 985, in assert_same_rank
    (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) must have the same rank

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 1015, in with_rank
    return self.merge_with(unknown_shape(rank=rank))
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 936, in merge_with
    raise ValueError("Shapes %s and %s are not compatible" % (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) are not compatible

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/nn_ops.py", line 1039, in __init__
    input_shape.with_rank(num_spatial_dims + 2)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 1017, in with_rank
    raise ValueError("Shape %s must have rank %d" % (self, rank))
ValueError: Shape (32, 10) must have rank 4

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 70, in process_tensor
    result = self.model.process_data(parsed)
  File "inference.py", line 127, in process_data
    result = self.model(input_data)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/sequential.py", line 277, in call
    return super(Sequential, self).call(inputs, training=training, mask=mask)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/network.py", line 719, in call
    convert_kwargs_to_constants=base_layer_utils.call_context().saving)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/network.py", line 888, in _run_internal_graph
    output_tensors = layer(computed_tensors, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/layers/convolutional.py", line 201, in call
    data_format=self._conv_op_data_format)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/nn_ops.py", line 1042, in __init__
    "input tensor must have rank %d" % (num_spatial_dims + 2))
ValueError: input tensor must have rank 4
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fdf32ab2680>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: input tensor must have rank 4"
	debug_error_string = "{"created":"@1593486394.964904086","description":"Error received from peer ipv4:172.19.0.3:50051","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: input tensor must have rank 4","grpc_status":2}"
>
WARNING:tensorflow:Model was constructed with shape (None, 28, 28, 1) for input Tensor("conv2d_input:0", shape=(None, 28, 28, 1), dtype=float32), but it was called on an input with incompatible shape (32, 10).
ERROR:grpc._server:Exception calling application: input tensor must have rank 4
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 930, in merge_with
    self.assert_same_rank(other)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 985, in assert_same_rank
    (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) must have the same rank

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 1015, in with_rank
    return self.merge_with(unknown_shape(rank=rank))
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 936, in merge_with
    raise ValueError("Shapes %s and %s are not compatible" % (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) are not compatible

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/nn_ops.py", line 1039, in __init__
    input_shape.with_rank(num_spatial_dims + 2)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 1017, in with_rank
    raise ValueError("Shape %s must have rank %d" % (self, rank))
ValueError: Shape (32, 10) must have rank 4

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 70, in process_tensor
    result = self.model.process_data(parsed)
  File "inference.py", line 127, in process_data
    result = self.model(input_data)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/sequential.py", line 277, in call
    return super(Sequential, self).call(inputs, training=training, mask=mask)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/network.py", line 719, in call
    convert_kwargs_to_constants=base_layer_utils.call_context().saving)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/network.py", line 888, in _run_internal_graph
    output_tensors = layer(computed_tensors, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/layers/convolutional.py", line 201, in call
    data_format=self._conv_op_data_format)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/nn_ops.py", line 1042, in __init__
    "input tensor must have rank %d" % (num_spatial_dims + 2))
ValueError: input tensor must have rank 4
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fdf32aabcb0>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: input tensor must have rank 4"
	debug_error_string = "{"created":"@1593486395.973691811","description":"Error received from peer ipv4:172.19.0.3:50051","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: input tensor must have rank 4","grpc_status":2}"
>
WARNING:tensorflow:Model was constructed with shape (None, 28, 28, 1) for input Tensor("conv2d_input:0", shape=(None, 28, 28, 1), dtype=float32), but it was called on an input with incompatible shape (32, 10).
ERROR:grpc._server:Exception calling application: input tensor must have rank 4
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 930, in merge_with
    self.assert_same_rank(other)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 985, in assert_same_rank
    (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) must have the same rank

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 1015, in with_rank
    return self.merge_with(unknown_shape(rank=rank))
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 936, in merge_with
    raise ValueError("Shapes %s and %s are not compatible" % (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) are not compatible

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/nn_ops.py", line 1039, in __init__
    input_shape.with_rank(num_spatial_dims + 2)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 1017, in with_rank
    raise ValueError("Shape %s must have rank %d" % (self, rank))
ValueError: Shape (32, 10) must have rank 4

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 70, in process_tensor
    result = self.model.process_data(parsed)
  File "inference.py", line 127, in process_data
    result = self.model(input_data)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/sequential.py", line 277, in call
    return super(Sequential, self).call(inputs, training=training, mask=mask)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/network.py", line 719, in call
    convert_kwargs_to_constants=base_layer_utils.call_context().saving)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/network.py", line 888, in _run_internal_graph
    output_tensors = layer(computed_tensors, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/layers/convolutional.py", line 201, in call
    data_format=self._conv_op_data_format)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/nn_ops.py", line 1042, in __init__
    "input tensor must have rank %d" % (num_spatial_dims + 2))
ValueError: input tensor must have rank 4
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fdf32aabe60>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: input tensor must have rank 4"
	debug_error_string = "{"created":"@1593486396.981422431","description":"Error received from peer ipv4:172.19.0.3:50051","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: input tensor must have rank 4","grpc_status":2}"
>
WARNING:tensorflow:Model was constructed with shape (None, 28, 28, 1) for input Tensor("conv2d_input:0", shape=(None, 28, 28, 1), dtype=float32), but it was called on an input with incompatible shape (32, 10).
ERROR:grpc._server:Exception calling application: input tensor must have rank 4
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 930, in merge_with
    self.assert_same_rank(other)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 985, in assert_same_rank
    (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) must have the same rank

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 1015, in with_rank
    return self.merge_with(unknown_shape(rank=rank))
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 936, in merge_with
    raise ValueError("Shapes %s and %s are not compatible" % (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) are not compatible

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/nn_ops.py", line 1039, in __init__
    input_shape.with_rank(num_spatial_dims + 2)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 1017, in with_rank
    raise ValueError("Shape %s must have rank %d" % (self, rank))
ValueError: Shape (32, 10) must have rank 4

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 70, in process_tensor
    result = self.model.process_data(parsed)
  File "inference.py", line 127, in process_data
    result = self.model(input_data)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/sequential.py", line 277, in call
    return super(Sequential, self).call(inputs, training=training, mask=mask)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/network.py", line 719, in call
    convert_kwargs_to_constants=base_layer_utils.call_context().saving)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/network.py", line 888, in _run_internal_graph
    output_tensors = layer(computed_tensors, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/layers/convolutional.py", line 201, in call
    data_format=self._conv_op_data_format)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/nn_ops.py", line 1042, in __init__
    "input tensor must have rank %d" % (num_spatial_dims + 2))
ValueError: input tensor must have rank 4
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fdf32ab00e0>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: input tensor must have rank 4"
	debug_error_string = "{"created":"@1593486397.988268863","description":"Error received from peer ipv4:172.19.0.3:50051","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: input tensor must have rank 4","grpc_status":2}"
>
WARNING:tensorflow:Model was constructed with shape (None, 28, 28, 1) for input Tensor("conv2d_input:0", shape=(None, 28, 28, 1), dtype=float32), but it was called on an input with incompatible shape (32, 10).
ERROR:grpc._server:Exception calling application: input tensor must have rank 4
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 930, in merge_with
    self.assert_same_rank(other)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 985, in assert_same_rank
    (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) must have the same rank

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 1015, in with_rank
    return self.merge_with(unknown_shape(rank=rank))
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 936, in merge_with
    raise ValueError("Shapes %s and %s are not compatible" % (self, other))
ValueError: Shapes (32, 10) and (None, None, None, None) are not compatible

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/nn_ops.py", line 1039, in __init__
    input_shape.with_rank(num_spatial_dims + 2)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/framework/tensor_shape.py", line 1017, in with_rank
    raise ValueError("Shape %s must have rank %d" % (self, rank))
ValueError: Shape (32, 10) must have rank 4

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 70, in process_tensor
    result = self.model.process_data(parsed)
  File "inference.py", line 127, in process_data
    result = self.model(input_data)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/sequential.py", line 277, in call
    return super(Sequential, self).call(inputs, training=training, mask=mask)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/network.py", line 719, in call
    convert_kwargs_to_constants=base_layer_utils.call_context().saving)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/network.py", line 888, in _run_internal_graph
    output_tensors = layer(computed_tensors, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/keras/layers/convolutional.py", line 201, in call
    data_format=self._conv_op_data_format)
  File "/usr/local/lib/python3.7/dist-packages/tensorflow/python/ops/nn_ops.py", line 1042, in __init__
    "input tensor must have rank %d" % (num_spatial_dims + 2))
ValueError: input tensor must have rank 4
ERROR:root:Exception in callback <function request_next_tensor.<locals>.process_response at 0x7fdf32aabcb0>: <_MultiThreadedRendezvous of RPC that terminated with:
	status = StatusCode.UNKNOWN
	details = "Exception calling application: input tensor must have rank 4"
	debug_error_string = "{"created":"@1593486398.992899298","description":"Error received from peer ipv4:172.19.0.3:50051","file":"src/core/lib/surface/call.cc","file_line":1055,"grpc_message":"Exception calling application: input tensor must have rank 4","grpc_status":2}"
>
