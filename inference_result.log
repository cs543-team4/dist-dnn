INFO:root:predictions: [7, 2, 1, 0, 4, 1, 4, 9, 5, 9, 0, 6, 9, 0, 1, 5, 9, 7, 8, 4, 9, 6, 6, 5, 4, 0, 7, 4, 0, 1, 3, 1]
INFO:root:labels: [7 2 1 0 4 1 4 9 5 9 0 6 9 0 1 5 9 7 3 4 9 6 6 5 4 0 7 4 0 1 3 1]
INFO:root:predictions: [7, 2, 1, 0, 4, 1, 4, 9, 5, 9, 0, 6, 9, 0, 1, 5, 9, 7, 8, 4, 9, 6, 6, 5, 4, 0, 7, 4, 0, 1, 3, 1]
INFO:root:labels: [3 4 7 2 7 1 2 1 1 7 4 2 3 5 1 2 4 4 6 3 5 5 6 0 4 1 9 5 7 8 9 3]
INFO:root:test loss: 5.005849361419678, test accuracy: 0.546875
ERROR:grpc._server:Exception calling application: 'str' object has no attribute '_keras_mask'
Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 70, in test_process
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/sequential.py", line 277, in call
    return super(Sequential, self).call(inputs, training=training, mask=mask)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/network.py", line 719, in call
    convert_kwargs_to_constants=base_layer_utils.call_context().saving)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/network.py", line 832, in _run_internal_graph
    input_t._keras_mask = mask
AttributeError: 'str' object has no attribute '_keras_mask'
ERROR:grpc._server:Exception calling application: 'str' object has no attribute '_keras_mask'
Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 70, in test_process
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py", line 968, in __call__
    outputs = self.call(cast_inputs, *args, **kwargs)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/sequential.py", line 277, in call
    return super(Sequential, self).call(inputs, training=training, mask=mask)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/network.py", line 719, in call
    convert_kwargs_to_constants=base_layer_utils.call_context().saving)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/network.py", line 832, in _run_internal_graph
    input_t._keras_mask = mask
AttributeError: 'str' object has no attribute '_keras_mask'
ERROR:grpc._server:Exception calling application: Type mismatch between parsed tensor (double) and dtype (float) [Op:ParseTensor]
Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 64, in test_process
    intermediate_prediction = parse(data)
  File "/home/greenmon/Projects/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2160, in parse_tensor
    _ops.raise_from_not_ok_status(e, name)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/ops.py", line 6653, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: Type mismatch between parsed tensor (double) and dtype (float) [Op:ParseTensor]
ERROR:grpc._server:Exception calling application: Type mismatch between parsed tensor (double) and dtype (float) [Op:ParseTensor]
Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 64, in test_process
    print('test data type: ', type(data))
  File "/home/greenmon/Projects/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2160, in parse_tensor
    _ops.raise_from_not_ok_status(e, name)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/ops.py", line 6653, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: Type mismatch between parsed tensor (double) and dtype (float) [Op:ParseTensor]
ERROR:grpc._server:Exception calling application: Type mismatch between parsed tensor (double) and dtype (float) [Op:ParseTensor]
Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 65, in test_process
    intermediate_prediction = parse(data)
  File "/home/greenmon/Projects/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2160, in parse_tensor
    _ops.raise_from_not_ok_status(e, name)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/ops.py", line 6653, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: Type mismatch between parsed tensor (double) and dtype (float) [Op:ParseTensor]
ERROR:grpc._server:Exception calling application: Type mismatch between parsed tensor (double) and dtype (float) [Op:ParseTensor]
Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 64, in test_process
    intermediate_prediction = parse(data)
  File "/home/greenmon/Projects/dist-dnn/tensor_utils.py", line 5, in parse
    return tf.io.parse_tensor(tf.io.decode_base64(encoded_tensor), tf.float32)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/ops/gen_parsing_ops.py", line 2160, in parse_tensor
    _ops.raise_from_not_ok_status(e, name)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/framework/ops.py", line 6653, in raise_from_not_ok_status
    six.raise_from(core._status_to_exception(e.code, message), None)
  File "<string>", line 3, in raise_from
tensorflow.python.framework.errors_impl.InvalidArgumentError: Type mismatch between parsed tensor (double) and dtype (float) [Op:ParseTensor]
ERROR:grpc._common:Exception serializing message!
Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/grpc/_common.py", line 84, in _transform
    return transformer(message)
TypeError: descriptor 'SerializeToString' requires a 'google.protobuf.pyext._message.CMessage' object but received a 'NoneType'
ERROR:grpc._common:Exception serializing message!
Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/grpc/_common.py", line 84, in _transform
    return transformer(message)
TypeError: descriptor 'SerializeToString' requires a 'google.protobuf.pyext._message.CMessage' object but received a 'NoneType'
ERROR:grpc._common:Exception serializing message!
Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/grpc/_common.py", line 84, in _transform
    return transformer(message)
TypeError: descriptor 'SerializeToString' requires a 'google.protobuf.pyext._message.CMessage' object but received a 'NoneType'
ERROR:grpc._common:Exception serializing message!
Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/grpc/_common.py", line 84, in _transform
    return transformer(message)
TypeError: descriptor 'SerializeToString' requires a 'google.protobuf.pyext._message.CMessage' object but received a 'NoneType'
ERROR:grpc._server:Exception calling application: list index out of range
Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 87, in split_model
    self.model.split_model(start, end)
  File "inference.py", line 132, in split_model
    split_model.build(input_shape=layers[0].input_shape)
IndexError: list index out of range
ERROR:grpc._server:Exception calling application: Input 0 of layer dense is incompatible with the layer: expected axis -1 of input shape to have value 21632 but received input with shape [None, 28, 28, 1]
Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 87, in split_model
    self.model.split_model(start, end)
  File "inference.py", line 132, in split_model
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/sequential.py", line 266, in build
    super(Sequential, self).build(input_shape)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/network.py", line 685, in build
    self.call(x, **kwargs)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/sequential.py", line 291, in call
    outputs = layer(inputs, **kwargs)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py", line 886, in __call__
    self.name)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/input_spec.py", line 216, in assert_input_compatibility
    ' but received input with shape ' + str(shape))
ValueError: Input 0 of layer dense is incompatible with the layer: expected axis -1 of input shape to have value 21632 but received input with shape [None, 28, 28, 1]
ERROR:grpc._server:Exception calling application: list index out of range
Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 87, in split_model
    self.model.split_model(start, end)
  File "inference.py", line 132, in split_model
    split_model.add(layer)
IndexError: list index out of range
ERROR:grpc._server:Exception calling application: Input 0 of layer dense is incompatible with the layer: expected axis -1 of input shape to have value 21632 but received input with shape [None, 784]
Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 87, in split_model
    self.model.split_model(start, end)
  File "inference.py", line 134, in split_model
    split_model.build(input_shape=layers[0].input_shape)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/sequential.py", line 266, in build
    super(Sequential, self).build(input_shape)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/network.py", line 685, in build
    self.call(x, **kwargs)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/sequential.py", line 291, in call
    outputs = layer(inputs, **kwargs)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py", line 886, in __call__
    self.name)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/input_spec.py", line 216, in assert_input_compatibility
    ' but received input with shape ' + str(shape))
ValueError: Input 0 of layer dense is incompatible with the layer: expected axis -1 of input shape to have value 21632 but received input with shape [None, 784]
ERROR:grpc._server:Exception calling application: 'Sequential' object has no attribute 'model'
Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 72, in test_process
    for layer in self.model.model.layers:
AttributeError: 'Sequential' object has no attribute 'model'
ERROR:grpc._server:Exception calling application: Input 0 of layer dense is incompatible with the layer: expected axis -1 of input shape to have value 21632 but received input with shape [None, 784]
Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 89, in split_model
    self.model.split_model(start, end)
  File "inference.py", line 138, in split_model
    split_model.build(input_shape=layers[0].input_shape)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/sequential.py", line 266, in build
    super(Sequential, self).build(input_shape)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/network.py", line 685, in build
    self.call(x, **kwargs)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/sequential.py", line 291, in call
    outputs = layer(inputs, **kwargs)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py", line 886, in __call__
    self.name)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/input_spec.py", line 216, in assert_input_compatibility
    ' but received input with shape ' + str(shape))
ValueError: Input 0 of layer dense is incompatible with the layer: expected axis -1 of input shape to have value 21632 but received input with shape [None, 784]
ERROR:grpc._server:Exception calling application: Input 0 of layer dense_1 is incompatible with the layer: expected axis -1 of input shape to have value 128 but received input with shape [None, 28, 28, 1]
Traceback (most recent call last):
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/grpc/_server.py", line 435, in _call_behavior
    response_or_iterator = behavior(argument, context)
  File "inference.py", line 89, in split_model
    self.model.split_model(start, end)
  File "inference.py", line 138, in split_model
    split_model.build(input_shape=layers[start].input_shape)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/sequential.py", line 266, in build
    super(Sequential, self).build(input_shape)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/network.py", line 685, in build
    self.call(x, **kwargs)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/sequential.py", line 291, in call
    outputs = layer(inputs, **kwargs)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py", line 886, in __call__
    self.name)
  File "/home/greenmon/.pyenv/versions/tensorflow-env/lib/python3.7/site-packages/tensorflow/python/keras/engine/input_spec.py", line 216, in assert_input_compatibility
    ' but received input with shape ' + str(shape))
ValueError: Input 0 of layer dense_1 is incompatible with the layer: expected axis -1 of input shape to have value 128 but received input with shape [None, 28, 28, 1]
